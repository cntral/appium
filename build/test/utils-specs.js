"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _chai = _interopRequireDefault(require("chai"));

var _chaiAsPromised = _interopRequireDefault(require("chai-as-promised"));

var _utils = require("../lib/utils");

var _helpers = require("./helpers");

var _lodash = _interopRequireDefault(require("lodash"));

const should = _chai.default.should();

_chai.default.use(_chaiAsPromised.default);

describe('utils', function () {
  describe('parseCapsForInnerDriver()', function () {
    it('should return JSONWP caps unchanged if only JSONWP caps provided', function () {
      let {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities,
        protocol
      } = (0, _utils.parseCapsForInnerDriver)(_helpers.BASE_CAPS);
      desiredCaps.should.deep.equal(_helpers.BASE_CAPS);
      processedJsonwpCapabilities.should.deep.equal(_helpers.BASE_CAPS);
      should.not.exist(processedW3CCapabilities);
      protocol.should.equal('MJSONWP');
    });
    it('should return W3C caps unchanged if only W3C caps were provided', function () {
      let {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities,
        protocol
      } = (0, _utils.parseCapsForInnerDriver)(undefined, _helpers.W3C_CAPS);
      desiredCaps.should.deep.equal(_helpers.BASE_CAPS);
      should.not.exist(processedJsonwpCapabilities);
      processedW3CCapabilities.should.deep.equal(_helpers.W3C_CAPS);
      protocol.should.equal('W3C');
    });
    it('should return JSONWP and W3C caps if both were provided', function () {
      let {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities,
        protocol
      } = (0, _utils.parseCapsForInnerDriver)(_helpers.BASE_CAPS, _helpers.W3C_CAPS);
      desiredCaps.should.deep.equal(_helpers.BASE_CAPS);
      processedJsonwpCapabilities.should.deep.equal(_helpers.BASE_CAPS);
      processedW3CCapabilities.should.deep.equal(_helpers.W3C_CAPS);
      protocol.should.equal('W3C');
    });
    it('should include default capabilities in results', function () {
      const defaultCaps = {
        foo: 'bar',
        baz: 'bla'
      };
      const {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities
      } = (0, _utils.parseCapsForInnerDriver)(_helpers.BASE_CAPS, _helpers.W3C_CAPS, {}, defaultCaps);
      desiredCaps.should.deep.equal({ ...defaultCaps,
        ..._helpers.BASE_CAPS
      });
      processedJsonwpCapabilities.should.deep.equal({ ...defaultCaps,
        ..._helpers.BASE_CAPS
      });
      processedW3CCapabilities.alwaysMatch.should.deep.equal({ ...(0, _utils.insertAppiumPrefixes)(defaultCaps),
        ...(0, _utils.insertAppiumPrefixes)(_helpers.BASE_CAPS)
      });
    });
    it('should include default capabilities into incomplete W3C caps', function () {
      const defaultCaps = {
        foo: 'bar',
        baz: 'bla'
      };
      const {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities
      } = (0, _utils.parseCapsForInnerDriver)({}, {
        alwaysMatch: {}
      }, {}, defaultCaps);
      desiredCaps.should.deep.equal({ ...defaultCaps
      });
      processedJsonwpCapabilities.should.deep.equal(defaultCaps);
      processedW3CCapabilities.alwaysMatch.should.deep.equal((0, _utils.insertAppiumPrefixes)(defaultCaps));
    });
    it('should rewrite default capabilities in results', function () {
      const baseCapsWithDefault = Object.assign({}, _helpers.BASE_CAPS, {
        foo: 'baz',
        'appium:foo2': 'baz2'
      });

      const w3cCapsWithDefault = _lodash.default.cloneDeep(_helpers.W3C_CAPS);

      w3cCapsWithDefault.alwaysMatch.foo = 'baz';
      w3cCapsWithDefault.alwaysMatch.foo2 = 'baz2';
      let {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities
      } = (0, _utils.parseCapsForInnerDriver)(baseCapsWithDefault, w3cCapsWithDefault, {}, {
        foo: 'bar',
        'appium:foo2': 'bar2'
      });
      desiredCaps.should.deep.equal({
        foo: 'baz',
        foo2: 'baz2',
        ..._helpers.BASE_CAPS
      });
      processedJsonwpCapabilities.should.deep.equal({
        foo: 'baz',
        foo2: 'bar2',
        'appium:foo2': 'baz2',
        ..._helpers.BASE_CAPS
      });
      processedW3CCapabilities.alwaysMatch.should.deep.equal({
        'appium:foo': 'baz',
        'appium:foo2': 'baz2',
        ...(0, _utils.insertAppiumPrefixes)(_helpers.BASE_CAPS)
      });
    });
    it('should reject if W3C caps are not passing constraints', function () {
      const err = (0, _utils.parseCapsForInnerDriver)(undefined, _helpers.W3C_CAPS, {
        hello: {
          presence: true
        }
      }).error;
      err.message.should.match(/'hello' can't be blank/);
      _lodash.default.isError(err).should.be.true;
    });
    it('should only accept W3C caps that have passing constraints', function () {
      let w3cCaps = { ..._helpers.W3C_CAPS,
        firstMatch: [{
          foo: 'bar'
        }, {
          hello: 'world'
        }]
      };
      let {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities,
        protocol
      } = (0, _utils.parseCapsForInnerDriver)(_helpers.BASE_CAPS, w3cCaps, {
        hello: {
          presence: true
        }
      });
      const expectedResult = {
        hello: 'world',
        ..._helpers.BASE_CAPS
      };
      desiredCaps.should.deep.equal(expectedResult);
      processedJsonwpCapabilities.should.deep.equal({ ..._helpers.BASE_CAPS
      });
      processedW3CCapabilities.alwaysMatch.should.deep.equal((0, _utils.insertAppiumPrefixes)(expectedResult));
      protocol.should.equal('W3C');
    });
    it('should add appium prefixes to W3C caps that are not standard in W3C', function () {
      (0, _utils.parseCapsForInnerDriver)(undefined, {
        alwaysMatch: {
          platformName: 'Fake',
          propertyName: 'PROP_NAME'
        }
      }).processedW3CCapabilities.should.deep.equal({
        alwaysMatch: {
          platformName: 'Fake',
          'appium:propertyName': 'PROP_NAME'
        },
        firstMatch: [{}]
      });
    });
    it('should merge extraneous MJSONWP caps into W3C', function () {
      let jsonwpCaps = { ..._helpers.BASE_CAPS,
        automationName: 'Fake'
      };
      const {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities,
        protocol
      } = (0, _utils.parseCapsForInnerDriver)(jsonwpCaps, {
        alwaysMatch: {
          platformName: 'Fake',
          propertyName: 'PROP_NAME'
        }
      });
      const expectedCaps = {};

      for (let [key, value] of _lodash.default.toPairs(jsonwpCaps)) {
        if (key !== 'platformName') {
          expectedCaps[`appium:${key}`] = value;
        } else {
          expectedCaps[key] = value;
        }
      }

      expectedCaps['appium:propertyName'] = 'PROP_NAME';
      processedW3CCapabilities.alwaysMatch.should.eql(expectedCaps);
      desiredCaps.should.eql({ ...jsonwpCaps,
        propertyName: 'PROP_NAME'
      });
      processedJsonwpCapabilities.should.eql(jsonwpCaps);
      protocol.should.equal('W3C');
    });
    it('should fix W3C caps by using MJSONWP if invalid W3C caps were provided', function () {
      let w3cCapabilities = {
        alwaysMatch: {
          platformName: 'Fake',
          propertyName: 'PROP_NAME'
        }
      };
      let constraints = {
        deviceName: {
          presence: true
        }
      };
      const {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities,
        protocol
      } = (0, _utils.parseCapsForInnerDriver)({ ..._helpers.BASE_CAPS
      }, w3cCapabilities, constraints);
      processedW3CCapabilities.should.exist;
      desiredCaps.should.eql({ ..._helpers.BASE_CAPS,
        propertyName: 'PROP_NAME'
      });
      processedJsonwpCapabilities.should.eql(_helpers.BASE_CAPS);
      protocol.should.equal('W3C');
    });
  });
  describe('removeAppiumPrefixes()', function () {
    it('should remove appium prefixes from cap names', function () {
      (0, _utils.removeAppiumPrefixes)({
        'appium:cap1': 'value1',
        'ms:cap2': 'value2',
        someCap: 'someCap'
      }).should.eql({
        'cap1': 'value1',
        'ms:cap2': 'value2',
        someCap: 'someCap'
      });
    });
  });
  describe('insertAppiumPrefixes()', function () {
    it('should apply prefixes to non-standard capabilities', function () {
      (0, _utils.insertAppiumPrefixes)({
        someCap: 'someCap'
      }).should.deep.equal({
        'appium:someCap': 'someCap'
      });
    });
    it('should not apply prefixes to standard capabilities', function () {
      (0, _utils.insertAppiumPrefixes)({
        browserName: 'BrowserName',
        platformName: 'PlatformName'
      }).should.deep.equal({
        browserName: 'BrowserName',
        platformName: 'PlatformName'
      });
    });
    it('should not apply prefixes to capabilities that already have a prefix', function () {
      (0, _utils.insertAppiumPrefixes)({
        'appium:someCap': 'someCap',
        'moz:someOtherCap': 'someOtherCap'
      }).should.deep.equal({
        'appium:someCap': 'someCap',
        'moz:someOtherCap': 'someOtherCap'
      });
    });
    it('should apply prefixes to non-prefixed, non-standard capabilities; should not apply prefixes to any other capabilities', function () {
      (0, _utils.insertAppiumPrefixes)({
        'appium:someCap': 'someCap',
        'moz:someOtherCap': 'someOtherCap',
        browserName: 'BrowserName',
        platformName: 'PlatformName',
        someOtherCap: 'someOtherCap',
        yetAnotherCap: 'yetAnotherCap'
      }).should.deep.equal({
        'appium:someCap': 'someCap',
        'moz:someOtherCap': 'someOtherCap',
        browserName: 'BrowserName',
        platformName: 'PlatformName',
        'appium:someOtherCap': 'someOtherCap',
        'appium:yetAnotherCap': 'yetAnotherCap'
      });
    });
  });
  describe('pullSettings()', function () {
    it('should pull settings from caps', function () {
      const caps = {
        platformName: 'foo',
        browserName: 'bar',
        'settings[settingName]': 'baz',
        'settings[settingName2]': 'baz2'
      };
      const settings = (0, _utils.pullSettings)(caps);
      settings.should.eql({
        settingName: 'baz',
        settingName2: 'baz2'
      });
      caps.should.eql({
        platformName: 'foo',
        browserName: 'bar'
      });
    });
    it('should pull settings dict if object values are present in caps', function () {
      const caps = {
        platformName: 'foo',
        browserName: 'bar',
        'settings[settingName]': {
          key: 'baz'
        }
      };
      const settings = (0, _utils.pullSettings)(caps);
      settings.should.eql({
        settingName: {
          key: 'baz'
        }
      });
      caps.should.eql({
        platformName: 'foo',
        browserName: 'bar'
      });
    });
    it('should pull empty dict if no settings are present in caps', function () {
      const caps = {
        platformName: 'foo',
        browserName: 'bar',
        'setting[settingName]': 'baz'
      };
      const settings = (0, _utils.pullSettings)(caps);
      settings.should.eql({});
      caps.should.eql({
        platformName: 'foo',
        browserName: 'bar',
        'setting[settingName]': 'baz'
      });
    });
    it('should pull empty dict if caps are empty', function () {
      const caps = {};
      const settings = (0, _utils.pullSettings)(caps);
      settings.should.eql({});
      caps.should.eql({});
    });
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdXRpbHMtc3BlY3MuanMiXSwibmFtZXMiOlsic2hvdWxkIiwiY2hhaSIsInVzZSIsImNoYWlBc1Byb21pc2VkIiwiZGVzY3JpYmUiLCJpdCIsImRlc2lyZWRDYXBzIiwicHJvY2Vzc2VkSnNvbndwQ2FwYWJpbGl0aWVzIiwicHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzIiwicHJvdG9jb2wiLCJCQVNFX0NBUFMiLCJkZWVwIiwiZXF1YWwiLCJub3QiLCJleGlzdCIsInVuZGVmaW5lZCIsIlczQ19DQVBTIiwiZGVmYXVsdENhcHMiLCJmb28iLCJiYXoiLCJhbHdheXNNYXRjaCIsImJhc2VDYXBzV2l0aERlZmF1bHQiLCJPYmplY3QiLCJhc3NpZ24iLCJ3M2NDYXBzV2l0aERlZmF1bHQiLCJfIiwiY2xvbmVEZWVwIiwiZm9vMiIsImVyciIsImhlbGxvIiwicHJlc2VuY2UiLCJlcnJvciIsIm1lc3NhZ2UiLCJtYXRjaCIsImlzRXJyb3IiLCJiZSIsInRydWUiLCJ3M2NDYXBzIiwiZmlyc3RNYXRjaCIsImV4cGVjdGVkUmVzdWx0IiwicGxhdGZvcm1OYW1lIiwicHJvcGVydHlOYW1lIiwianNvbndwQ2FwcyIsImF1dG9tYXRpb25OYW1lIiwiZXhwZWN0ZWRDYXBzIiwia2V5IiwidmFsdWUiLCJ0b1BhaXJzIiwiZXFsIiwidzNjQ2FwYWJpbGl0aWVzIiwiY29uc3RyYWludHMiLCJkZXZpY2VOYW1lIiwic29tZUNhcCIsImJyb3dzZXJOYW1lIiwic29tZU90aGVyQ2FwIiwieWV0QW5vdGhlckNhcCIsImNhcHMiLCJzZXR0aW5ncyIsInNldHRpbmdOYW1lIiwic2V0dGluZ05hbWUyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFJQTs7QUFDQTs7QUFHQSxNQUFNQSxNQUFNLEdBQUdDLGNBQUtELE1BQUwsRUFBZjs7QUFDQUMsY0FBS0MsR0FBTCxDQUFTQyx1QkFBVDs7QUFFQUMsUUFBUSxDQUFDLE9BQUQsRUFBVSxZQUFZO0FBQzVC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Q0FRLE1BQUFBLElBQUksQ0FBQ3hELE1BQUwsQ0FBWWdELEdBQVosQ0FBZ0I7QUFDZFIsUUFBQUEsWUFBWSxFQUFFLEtBREE7QUFFZGEsUUFBQUEsV0FBVyxFQUFFLEtBRkM7QUFHZCxnQ0FBd0I7QUFIVixPQUFoQjtBQUtELEtBYkMsQ0FBRjtBQWNBaEQsSUFBQUEsRUFBRSxDQUFDLDBDQUFELEVBQTZDLFlBQVk7QUFDekQsWUFBTW1ELElBQUksR0FBRyxFQUFiO0FBQ0EsWUFBTUMsUUFBUSxHQUFHLHlCQUFhRCxJQUFiLENBQWpCO0FBQ0FDLE1BQUFBLFFBQVEsQ0FBQ3pELE1BQVQsQ0FBZ0JnRCxHQUFoQixDQUFvQixFQUFwQjtBQUNBUSxNQUFBQSxJQUFJLENBQUN4RCxNQUFMLENBQVlnRCxHQUFaLENBQWdCLEVBQWhCO0FBQ0QsS0FMQyxDQUFGO0FBTUQsR0FyRE8sQ0FBUjtBQXNERCxDQXBSTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNoYWkgZnJvbSAnY2hhaSc7XG5pbXBvcnQgY2hhaUFzUHJvbWlzZWQgZnJvbSAnY2hhaS1hcy1wcm9taXNlZCc7XG5pbXBvcnQge1xuICBwYXJzZUNhcHNGb3JJbm5lckRyaXZlciwgaW5zZXJ0QXBwaXVtUHJlZml4ZXMsIHB1bGxTZXR0aW5ncyxcbiAgcmVtb3ZlQXBwaXVtUHJlZml4ZXMsXG59IGZyb20gJy4uL2xpYi91dGlscyc7XG5pbXBvcnQgeyBCQVNFX0NBUFMsIFczQ19DQVBTIH0gZnJvbSAnLi9oZWxwZXJzJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cblxuY29uc3Qgc2hvdWxkID0gY2hhaS5zaG91bGQoKTtcbmNoYWkudXNlKGNoYWlBc1Byb21pc2VkKTtcblxuZGVzY3JpYmUoJ3V0aWxzJywgZnVuY3Rpb24gKCkge1xuICBkZXNjcmliZSgncGFyc2VDYXBzRm9ySW5uZXJEcml2ZXIoKScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBKU09OV1AgY2FwcyB1bmNoYW5nZWQgaWYgb25seSBKU09OV1AgY2FwcyBwcm92aWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB7ZGVzaXJlZENhcHMsIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcywgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzLCBwcm90b2NvbH0gPSBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcihCQVNFX0NBUFMpO1xuICAgICAgZGVzaXJlZENhcHMuc2hvdWxkLmRlZXAuZXF1YWwoQkFTRV9DQVBTKTtcbiAgICAgIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbChCQVNFX0NBUFMpO1xuICAgICAgc2hvdWxkLm5vdC5leGlzdChwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMpO1xuICAgICAgcHJvdG9jb2wuc2hvdWxkLmVxdWFsKCdNSlNPTldQJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gVzNDIGNhcHMgdW5jaGFuZ2VkIGlmIG9ubHkgVzNDIGNhcHMgd2VyZSBwcm92aWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB7ZGVzaXJlZENhcHMsIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcywgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzLCBwcm90b2NvbH0gPSBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcih1bmRlZmluZWQsIFczQ19DQVBTKTtcbiAgICAgIGRlc2lyZWRDYXBzLnNob3VsZC5kZWVwLmVxdWFsKEJBU0VfQ0FQUyk7XG4gICAgICBzaG91bGQubm90LmV4aXN0KHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcyk7XG4gICAgICBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMuc2hvdWxkLmRlZXAuZXF1YWwoVzNDX0NBUFMpO1xuICAgICAgcHJvdG9jb2wuc2hvdWxkLmVxdWFsKCdXM0MnKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBKU09OV1AgYW5kIFczQyBjYXBzIGlmIGJvdGggd2VyZSBwcm92aWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB7ZGVzaXJlZENhcHMsIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcywgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzLCBwcm90b2NvbH0gPSBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcihCQVNFX0NBUFMsIFczQ19DQVBTKTtcbiAgICAgIGRlc2lyZWRDYXBzLnNob3VsZC5kZWVwLmVxdWFsKEJBU0VfQ0FQUyk7XG4gICAgICBwcm9jZXNzZWRKc29ud3BDYXBhYmlsaXRpZXMuc2hvdWxkLmRlZXAuZXF1YWwoQkFTRV9DQVBTKTtcbiAgICAgIHByb2Nlc3NlZFczQ0NhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbChXM0NfQ0FQUyk7XG4gICAgICBwcm90b2NvbC5zaG91bGQuZXF1YWwoJ1czQycpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBkZWZhdWx0IGNhcGFiaWxpdGllcyBpbiByZXN1bHRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZGVmYXVsdENhcHMgPSB7XG4gICAgICAgIGZvbzogJ2JhcicsXG4gICAgICAgIGJhejogJ2JsYScsXG4gICAgICB9O1xuICAgICAgY29uc3Qge1xuICAgICAgICBkZXNpcmVkQ2FwcyxcbiAgICAgICAgcHJvY2Vzc2VkSnNvbndwQ2FwYWJpbGl0aWVzLFxuICAgICAgICBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXNcbiAgICAgIH0gPSBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcihCQVNFX0NBUFMsIFczQ19DQVBTLCB7fSwgZGVmYXVsdENhcHMpO1xuICAgICAgZGVzaXJlZENhcHMuc2hvdWxkLmRlZXAuZXF1YWwoe1xuICAgICAgICAuLi5kZWZhdWx0Q2FwcyxcbiAgICAgICAgLi4uQkFTRV9DQVBTLFxuICAgICAgfSk7XG4gICAgICBwcm9jZXNzZWRKc29ud3BDYXBhYmlsaXRpZXMuc2hvdWxkLmRlZXAuZXF1YWwoe1xuICAgICAgICAuLi5kZWZhdWx0Q2FwcyxcbiAgICAgICAgLi4uQkFTRV9DQVBTXG4gICAgICB9KTtcbiAgICAgIHByb2Nlc3NlZFczQ0NhcGFiaWxpdGllcy5hbHdheXNNYXRjaC5zaG91bGQuZGVlcC5lcXVhbCh7XG4gICAgICAgIC4uLmluc2VydEFwcGl1bVByZWZpeGVzKGRlZmF1bHRDYXBzKSxcbiAgICAgICAgLi4uaW5zZXJ0QXBwaXVtUHJlZml4ZXMoQkFTRV9DQVBTKVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIGRlZmF1bHQgY2FwYWJpbGl0aWVzIGludG8gaW5jb21wbGV0ZSBXM0MgY2FwcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGRlZmF1bHRDYXBzID0ge1xuICAgICAgICBmb286ICdiYXInLFxuICAgICAgICBiYXo6ICdibGEnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZGVzaXJlZENhcHMsXG4gICAgICAgIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcyxcbiAgICAgICAgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzXG4gICAgICB9ID0gcGFyc2VDYXBzRm9ySW5uZXJEcml2ZXIoe30sIHtcbiAgICAgICAgYWx3YXlzTWF0Y2g6IHt9LFxuICAgICAgfSwge30sIGRlZmF1bHRDYXBzKTtcbiAgICAgIGRlc2lyZWRDYXBzLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgLi4uZGVmYXVsdENhcHMsXG4gICAgICB9KTtcbiAgICAgIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbChkZWZhdWx0Q2Fwcyk7XG4gICAgICBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMuYWx3YXlzTWF0Y2guc2hvdWxkLmRlZXAuZXF1YWwoXG4gICAgICAgIGluc2VydEFwcGl1bVByZWZpeGVzKGRlZmF1bHRDYXBzKVxuICAgICAgKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJld3JpdGUgZGVmYXVsdCBjYXBhYmlsaXRpZXMgaW4gcmVzdWx0cycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGJhc2VDYXBzV2l0aERlZmF1bHQgPSBPYmplY3QuYXNzaWduKHt9LCBCQVNFX0NBUFMsIHtcbiAgICAgICAgZm9vOiAnYmF6JyxcbiAgICAgICAgJ2FwcGl1bTpmb28yJzogJ2JhejInLFxuICAgICAgfSk7XG4gICAgICBjb25zdCB3M2NDYXBzV2l0aERlZmF1bHQgPSBfLmNsb25lRGVlcChXM0NfQ0FQUyk7XG4gICAgICB3M2NDYXBzV2l0aERlZmF1bHQuYWx3YXlzTWF0Y2guZm9vID0gJ2Jheic7XG4gICAgICB3M2NDYXBzV2l0aERlZmF1bHQuYWx3YXlzTWF0Y2guZm9vMiA9ICdiYXoyJztcbiAgICAgIGxldCB7ZGVzaXJlZENhcHMsIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcywgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzfSA9IHBhcnNlQ2Fwc0ZvcklubmVyRHJpdmVyKGJhc2VDYXBzV2l0aERlZmF1bHQsIHczY0NhcHNXaXRoRGVmYXVsdCwge30sIHtcbiAgICAgICAgZm9vOiAnYmFyJyxcbiAgICAgICAgJ2FwcGl1bTpmb28yJzogJ2JhcjInLFxuICAgICAgfSk7XG4gICAgICBkZXNpcmVkQ2Fwcy5zaG91bGQuZGVlcC5lcXVhbCh7Zm9vOiAnYmF6JywgZm9vMjogJ2JhejInLCAuLi5CQVNFX0NBUFN9KTtcbiAgICAgIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbCh7Zm9vOiAnYmF6JywgZm9vMjogJ2JhcjInLCAnYXBwaXVtOmZvbzInOiAnYmF6MicsIC4uLkJBU0VfQ0FQU30pO1xuICAgICAgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzLmFsd2F5c01hdGNoLnNob3VsZC5kZWVwLmVxdWFsKHsnYXBwaXVtOmZvbyc6ICdiYXonLCAnYXBwaXVtOmZvbzInOiAnYmF6MicsIC4uLmluc2VydEFwcGl1bVByZWZpeGVzKEJBU0VfQ0FQUyl9KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpZiBXM0MgY2FwcyBhcmUgbm90IHBhc3NpbmcgY29uc3RyYWludHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBlcnIgPSBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcih1bmRlZmluZWQsIFczQ19DQVBTLCB7aGVsbG86IHtwcmVzZW5jZTogdHJ1ZX19KS5lcnJvcjtcbiAgICAgIGVyci5tZXNzYWdlLnNob3VsZC5tYXRjaCgvJ2hlbGxvJyBjYW4ndCBiZSBibGFuay8pO1xuICAgICAgXy5pc0Vycm9yKGVycikuc2hvdWxkLmJlLnRydWU7XG5cbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIG9ubHkgYWNjZXB0IFczQyBjYXBzIHRoYXQgaGF2ZSBwYXNzaW5nIGNvbnN0cmFpbnRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHczY0NhcHMgPSB7XG4gICAgICAgIC4uLlczQ19DQVBTLFxuICAgICAgICBmaXJzdE1hdGNoOiBbXG4gICAgICAgICAge2ZvbzogJ2Jhcid9LFxuICAgICAgICAgIHtoZWxsbzogJ3dvcmxkJ30sXG4gICAgICAgIF0sXG4gICAgICB9O1xuICAgICAgbGV0IHtkZXNpcmVkQ2FwcywgcHJvY2Vzc2VkSnNvbndwQ2FwYWJpbGl0aWVzLCBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMsIHByb3RvY29sfSA9IHBhcnNlQ2Fwc0ZvcklubmVyRHJpdmVyKEJBU0VfQ0FQUywgdzNjQ2Fwcywge2hlbGxvOiB7cHJlc2VuY2U6IHRydWV9fSk7XG4gICAgICBjb25zdCBleHBlY3RlZFJlc3VsdCA9IHtoZWxsbzogJ3dvcmxkJywgLi4uQkFTRV9DQVBTfTtcbiAgICAgIGRlc2lyZWRDYXBzLnNob3VsZC5kZWVwLmVxdWFsKGV4cGVjdGVkUmVzdWx0KTtcbiAgICAgIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcy5zaG91bGQuZGVlcC5lcXVhbCh7Li4uQkFTRV9DQVBTfSk7XG4gICAgICBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMuYWx3YXlzTWF0Y2guc2hvdWxkLmRlZXAuZXF1YWwoaW5zZXJ0QXBwaXVtUHJlZml4ZXMoZXhwZWN0ZWRSZXN1bHQpKTtcbiAgICAgIHByb3RvY29sLnNob3VsZC5lcXVhbCgnVzNDJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBhZGQgYXBwaXVtIHByZWZpeGVzIHRvIFczQyBjYXBzIHRoYXQgYXJlIG5vdCBzdGFuZGFyZCBpbiBXM0MnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcih1bmRlZmluZWQsIHtcbiAgICAgICAgYWx3YXlzTWF0Y2g6IHtcbiAgICAgICAgICBwbGF0Zm9ybU5hbWU6ICdGYWtlJyxcbiAgICAgICAgICBwcm9wZXJ0eU5hbWU6ICdQUk9QX05BTUUnLFxuICAgICAgICB9LFxuICAgICAgfSkucHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgYWx3YXlzTWF0Y2g6IHtcbiAgICAgICAgICBwbGF0Zm9ybU5hbWU6ICdGYWtlJyxcbiAgICAgICAgICAnYXBwaXVtOnByb3BlcnR5TmFtZSc6ICdQUk9QX05BTUUnLFxuICAgICAgICB9LFxuICAgICAgICBmaXJzdE1hdGNoOiBbe31dLFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBtZXJnZSBleHRyYW5lb3VzIE1KU09OV1AgY2FwcyBpbnRvIFczQycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBqc29ud3BDYXBzID0ge1xuICAgICAgICAuLi5CQVNFX0NBUFMsXG4gICAgICAgIGF1dG9tYXRpb25OYW1lOiAnRmFrZScsXG4gICAgICB9O1xuICAgICAgY29uc3Qge2Rlc2lyZWRDYXBzLCBwcm9jZXNzZWRKc29ud3BDYXBhYmlsaXRpZXMsIHByb2Nlc3NlZFczQ0NhcGFiaWxpdGllcywgcHJvdG9jb2x9ID0gcGFyc2VDYXBzRm9ySW5uZXJEcml2ZXIoanNvbndwQ2Fwcywge1xuICAgICAgICBhbHdheXNNYXRjaDoge3BsYXRmb3JtTmFtZTogJ0Zha2UnLCBwcm9wZXJ0eU5hbWU6ICdQUk9QX05BTUUnfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBXZSBleHBlY3QgYSBjb21ibyBvZiBqc29ud3AgY2FwcyBhbmQgdzNjIHByb3ZpZGVkIGNhcHMgd2l0aCBgYXBwaXVtOmAgcHJlZml4IGZvciBub24tc3RhbmRhcmQgY2Fwc1xuICAgICAgY29uc3QgZXhwZWN0ZWRDYXBzID0ge307XG5cbiAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBfLnRvUGFpcnMoanNvbndwQ2FwcykpIHtcbiAgICAgICAgaWYgKGtleSAhPT0gJ3BsYXRmb3JtTmFtZScpIHtcbiAgICAgICAgICBleHBlY3RlZENhcHNbYGFwcGl1bToke2tleX1gXSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGV4cGVjdGVkQ2Fwc1trZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGV4cGVjdGVkQ2Fwc1snYXBwaXVtOnByb3BlcnR5TmFtZSddID0gJ1BST1BfTkFNRSc7XG5cbiAgICAgIHByb2Nlc3NlZFczQ0NhcGFiaWxpdGllcy5hbHdheXNNYXRjaC5zaG91bGQuZXFsKGV4cGVjdGVkQ2Fwcyk7XG4gICAgICBkZXNpcmVkQ2Fwcy5zaG91bGQuZXFsKHtcbiAgICAgICAgLi4uanNvbndwQ2FwcyxcbiAgICAgICAgcHJvcGVydHlOYW1lOiAnUFJPUF9OQU1FJyxcbiAgICAgIH0pO1xuICAgICAgcHJvY2Vzc2VkSnNvbndwQ2FwYWJpbGl0aWVzLnNob3VsZC5lcWwoanNvbndwQ2Fwcyk7XG4gICAgICBwcm90b2NvbC5zaG91bGQuZXF1YWwoJ1czQycpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZml4IFczQyBjYXBzIGJ5IHVzaW5nIE1KU09OV1AgaWYgaW52YWxpZCBXM0MgY2FwcyB3ZXJlIHByb3ZpZGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHczY0NhcGFiaWxpdGllcyA9IHtcbiAgICAgICAgYWx3YXlzTWF0Y2g6IHtwbGF0Zm9ybU5hbWU6ICdGYWtlJywgcHJvcGVydHlOYW1lOiAnUFJPUF9OQU1FJ30sXG4gICAgICB9O1xuICAgICAgbGV0IGNvbnN0cmFpbnRzID0ge1xuICAgICAgICBkZXZpY2VOYW1lOiB7XG4gICAgICAgICAgcHJlc2VuY2U6IHRydWUsXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCB7ZGVzaXJlZENhcHMsIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcywgcHJvY2Vzc2VkVzNDQ2FwYWJpbGl0aWVzLCBwcm90b2NvbH0gPSBwYXJzZUNhcHNGb3JJbm5lckRyaXZlcih7Li4uQkFTRV9DQVBTfSwgdzNjQ2FwYWJpbGl0aWVzLCBjb25zdHJhaW50cyk7XG4gICAgICBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMuc2hvdWxkLmV4aXN0O1xuICAgICAgZGVzaXJlZENhcHMuc2hvdWxkLmVxbCh7Li4uQkFTRV9DQVBTLCBwcm9wZXJ0eU5hbWU6ICdQUk9QX05BTUUnfSk7XG4gICAgICBwcm9jZXNzZWRKc29ud3BDYXBhYmlsaXRpZXMuc2hvdWxkLmVxbChCQVNFX0NBUFMpO1xuICAgICAgcHJvdG9jb2wuc2hvdWxkLmVxdWFsKCdXM0MnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlbW92ZUFwcGl1bVByZWZpeGVzKCknLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgYXBwaXVtIHByZWZpeGVzIGZyb20gY2FwIG5hbWVzJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmVtb3ZlQXBwaXVtUHJlZml4ZXMoe1xuICAgICAgICAnYXBwaXVtOmNhcDEnOiAndmFsdWUxJyxcbiAgICAgICAgJ21zOmNhcDInOiAndmFsdWUyJyxcbiAgICAgICAgc29tZUNhcDogJ3NvbWVDYXAnLFxuICAgICAgfSkuc2hvdWxkLmVxbCh7XG4gICAgICAgICdjYXAxJzogJ3ZhbHVlMScsXG4gICAgICAgICdtczpjYXAyJzogJ3ZhbHVlMicsXG4gICAgICAgIHNvbWVDYXA6ICdzb21lQ2FwJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW5zZXJ0QXBwaXVtUHJlZml4ZXMoKScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGFwcGx5IHByZWZpeGVzIHRvIG5vbi1zdGFuZGFyZCBjYXBhYmlsaXRpZXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpbnNlcnRBcHBpdW1QcmVmaXhlcyh7XG4gICAgICAgIHNvbWVDYXA6ICdzb21lQ2FwJyxcbiAgICAgIH0pLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgJ2FwcGl1bTpzb21lQ2FwJzogJ3NvbWVDYXAnLFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBub3QgYXBwbHkgcHJlZml4ZXMgdG8gc3RhbmRhcmQgY2FwYWJpbGl0aWVzJywgZnVuY3Rpb24gKCkge1xuICAgICAgaW5zZXJ0QXBwaXVtUHJlZml4ZXMoe1xuICAgICAgICBicm93c2VyTmFtZTogJ0Jyb3dzZXJOYW1lJyxcbiAgICAgICAgcGxhdGZvcm1OYW1lOiAnUGxhdGZvcm1OYW1lJyxcbiAgICAgIH0pLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgYnJvd3Nlck5hbWU6ICdCcm93c2VyTmFtZScsXG4gICAgICAgIHBsYXRmb3JtTmFtZTogJ1BsYXRmb3JtTmFtZScsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIG5vdCBhcHBseSBwcmVmaXhlcyB0byBjYXBhYmlsaXRpZXMgdGhhdCBhbHJlYWR5IGhhdmUgYSBwcmVmaXgnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpbnNlcnRBcHBpdW1QcmVmaXhlcyh7XG4gICAgICAgICdhcHBpdW06c29tZUNhcCc6ICdzb21lQ2FwJyxcbiAgICAgICAgJ21vejpzb21lT3RoZXJDYXAnOiAnc29tZU90aGVyQ2FwJyxcbiAgICAgIH0pLnNob3VsZC5kZWVwLmVxdWFsKHtcbiAgICAgICAgJ2FwcGl1bTpzb21lQ2FwJzogJ3NvbWVDYXAnLFxuICAgICAgICAnbW96OnNvbWVPdGhlckNhcCc6ICdzb21lT3RoZXJDYXAnLFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBhcHBseSBwcmVmaXhlcyB0byBub24tcHJlZml4ZWQsIG5vbi1zdGFuZGFyZCBjYXBhYmlsaXRpZXM7IHNob3VsZCBub3QgYXBwbHkgcHJlZml4ZXMgdG8gYW55IG90aGVyIGNhcGFiaWxpdGllcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGluc2VydEFwcGl1bVByZWZpeGVzKHtcbiAgICAgICAgJ2FwcGl1bTpzb21lQ2FwJzogJ3NvbWVDYXAnLFxuICAgICAgICAnbW96OnNvbWVPdGhlckNhcCc6ICdzb21lT3RoZXJDYXAnLFxuICAgICAgICBicm93c2VyTmFtZTogJ0Jyb3dzZXJOYW1lJyxcbiAgICAgICAgcGxhdGZvcm1OYW1lOiAnUGxhdGZvcm1OYW1lJyxcbiAgICAgICAgc29tZU90aGVyQ2FwOiAnc29tZU90aGVyQ2FwJyxcbiAgICAgICAgeWV0QW5vdGhlckNhcDogJ3lldEFub3RoZXJDYXAnLFxuICAgICAgfSkuc2hvdWxkLmRlZXAuZXF1YWwoe1xuICAgICAgICAnYXBwaXVtOnNvbWVDYXAnOiAnc29tZUNhcCcsXG4gICAgICAgICdtb3o6c29tZU90aGVyQ2FwJzogJ3NvbWVPdGhlckNhcCcsXG4gICAgICAgIGJyb3dzZXJOYW1lOiAnQnJvd3Nlck5hbWUnLFxuICAgICAgICBwbGF0Zm9ybU5hbWU6ICdQbGF0Zm9ybU5hbWUnLFxuICAgICAgICAnYXBwaXVtOnNvbWVPdGhlckNhcCc6ICdzb21lT3RoZXJDYXAnLFxuICAgICAgICAnYXBwaXVtOnlldEFub3RoZXJDYXAnOiAneWV0QW5vdGhlckNhcCcsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3B1bGxTZXR0aW5ncygpJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgcHVsbCBzZXR0aW5ncyBmcm9tIGNhcHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjYXBzID0ge1xuICAgICAgICBwbGF0Zm9ybU5hbWU6ICdmb28nLFxuICAgICAgICBicm93c2VyTmFtZTogJ2JhcicsXG4gICAgICAgICdzZXR0aW5nc1tzZXR0aW5nTmFtZV0nOiAnYmF6JyxcbiAgICAgICAgJ3NldHRpbmdzW3NldHRpbmdOYW1lMl0nOiAnYmF6MicsXG4gICAgICB9O1xuICAgICAgY29uc3Qgc2V0dGluZ3MgPSBwdWxsU2V0dGluZ3MoY2Fwcyk7XG4gICAgICBzZXR0aW5ncy5zaG91bGQuZXFsKHtcbiAgICAgICAgc2V0dGluZ05hbWU6ICdiYXonLFxuICAgICAgICBzZXR0aW5nTmFtZTI6ICdiYXoyJyxcbiAgICAgIH0pO1xuICAgICAgY2Fwcy5zaG91bGQuZXFsKHtcbiAgICAgICAgcGxhdGZvcm1OYW1lOiAnZm9vJyxcbiAgICAgICAgYnJvd3Nlck5hbWU6ICdiYXInLFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwdWxsIHNldHRpbmdzIGRpY3QgaWYgb2JqZWN0IHZhbHVlcyBhcmUgcHJlc2VudCBpbiBjYXBzJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY2FwcyA9IHtcbiAgICAgICAgcGxhdGZvcm1OYW1lOiAnZm9vJyxcbiAgICAgICAgYnJvd3Nlck5hbWU6ICdiYXInLFxuICAgICAgICAnc2V0dGluZ3Nbc2V0dGluZ05hbWVdJzoge2tleTogJ2Jheid9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHNldHRpbmdzID0gcHVsbFNldHRpbmdzKGNhcHMpO1xuICAgICAgc2V0dGluZ3Muc2hvdWxkLmVxbCh7XG4gICAgICAgIHNldHRpbmdOYW1lOiB7a2V5OiAnYmF6J30sXG4gICAgICB9KTtcbiAgICAgIGNhcHMuc2hvdWxkLmVxbCh7XG4gICAgICAgIHBsYXRmb3JtTmFtZTogJ2ZvbycsXG4gICAgICAgIGJyb3dzZXJOYW1lOiAnYmFyJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcHVsbCBlbXB0eSBkaWN0IGlmIG5vIHNldHRpbmdzIGFyZSBwcmVzZW50IGluIGNhcHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjYXBzID0ge1xuICAgICAgICBwbGF0Zm9ybU5hbWU6ICdmb28nLFxuICAgICAgICBicm93c2VyTmFtZTogJ2JhcicsXG4gICAgICAgICdzZXR0aW5nW3NldHRpbmdOYW1lXSc6ICdiYXonLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHNldHRpbmdzID0gcHVsbFNldHRpbmdzKGNhcHMpO1xuICAgICAgc2V0dGluZ3Muc2hvdWxkLmVxbCh7fSk7XG4gICAgICBjYXBzLnNob3VsZC5lcWwoe1xuICAgICAgICBwbGF0Zm9ybU5hbWU6ICdmb28nLFxuICAgICAgICBicm93c2VyTmFtZTogJ2JhcicsXG4gICAgICAgICdzZXR0aW5nW3NldHRpbmdOYW1lXSc6ICdiYXonLFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwdWxsIGVtcHR5IGRpY3QgaWYgY2FwcyBhcmUgZW1wdHknLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjYXBzID0ge307XG4gICAgICBjb25zdCBzZXR0aW5ncyA9IHB1bGxTZXR0aW5ncyhjYXBzKTtcbiAgICAgIHNldHRpbmdzLnNob3VsZC5lcWwoe30pO1xuICAgICAgY2Fwcy5zaG91bGQuZXFsKHt9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJmaWxlIjoidGVzdC91dGlscy1zcGVjcy5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLiJ9
